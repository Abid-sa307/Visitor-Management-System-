<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Fix Test</title>
</head>
<body>
    <h1>Audio Notification Test</h1>
    <p>Test the enhanced audio notification system with multiple fallbacks</p>
    
    <button onclick="testAudioSystem()">üîä Test Audio System</button>
    <button onclick="testBeepOnly()">üìû Test Beep Only</button>
    
    <div id="status"></div>
    
    <script src="/js/beep-sound.js"></script>
    <script>
        function log(message) {
            const status = document.getElementById('status');
            const div = document.createElement('div');
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}:</strong> ${message}`;
            status.appendChild(div);
            console.log(message);
        }
        
        function testAudioSystem() {
            log('üîä Testing enhanced audio system...');
            
            // Try different audio sources
            const audioSources = [
                '/sounds/mixkit-bell-notification-933.wav',
                'data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ=='
            ];
            
            let attempt = 0;
            
            function tryNextSource() {
                if (attempt >= audioSources.length) {
                    log('‚ùå All audio sources failed, trying beep sound');
                    try {
                        if (typeof createBeepSound === 'function') {
                            createBeepSound();
                            log('‚úÖ Beep sound played successfully');
                        } else {
                            log('‚ùå Beep sound function not available');
                        }
                    } catch (e) {
                        log('‚ùå Beep sound failed: ' + e.message);
                    }
                    return;
                }
                
                try {
                    const audio = new Audio(audioSources[attempt]);
                    audio.volume = 0.6;
                    
                    audio.addEventListener('canplaythrough', () => {
                        log(`‚úÖ Audio source ${attempt + 1} ready`);
                    });
                    
                    audio.play().then(() => {
                        log(`‚úÖ Notification sound played successfully (source ${attempt + 1})`);
                    }).catch(e => {
                        log(`‚ùå Audio source ${attempt + 1} failed: ${e.message}`);
                        attempt++;
                        tryNextSource();
                    });
                    
                } catch (e) {
                    log(`‚ùå Audio source ${attempt + 1} creation failed: ${e.message}`);
                    attempt++;
                    tryNextSource();
                }
            }
            
            tryNextSource();
        }
        
        function testBeepOnly() {
            log('üìû Testing beep sound only...');
            try {
                if (typeof createBeepSound === 'function') {
                    createBeepSound();
                    log('‚úÖ Beep sound played successfully');
                } else {
                    log('‚ùå Beep sound function not available');
                }
            } catch (e) {
                log('‚ùå Beep sound failed: ' + e.message);
            }
        }
    </script>
</body>
</html>
